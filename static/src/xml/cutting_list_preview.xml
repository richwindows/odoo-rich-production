<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="rich_production.CuttingListPreview" owl="1">
        <t t-set="state" t-value="{ activeTab: 'general-info', ...state }"/>
        <div class="o_cutting_list_preview" t-on-component-mounted="() => { this.state.activeTab = 'general-info'; this.processWindowData(); }">
            <div class="o_control_panel py-2 d-flex justify-content-between align-items-center">
                <div class="o_cp_right ms-auto">
                    <button class="btn btn-sm btn-primary me-1" t-on-click="printPage">
                        <i class="fa fa-print me-1"/>Print
                    </button>
                    <button class="btn btn-sm btn-info me-1" t-on-click="downloadPdf">
                        <i class="fa fa-file-pdf-o me-1"/>Download PDF
                    </button>
                    <button class="btn btn-sm btn-success me-1" t-on-click="downloadExcel">
                        <i class="fa fa-file-excel-o me-1"/>Download Excel
                    </button>
                </div>
            </div>
            
            <div class="o_content p-3">
                <t t-if="state.loading">
                    <div class="o_loading text-center p-5">
                        <i class="fa fa-spinner fa-spin fa-3x"/>
                        <p class="mt-2">Loading...</p>
                    </div>
                </t>
                <t t-else="">
                    <!-- Tab navigation buttons layout -->
                    <div class="nav-tabs-container mb-3 d-flex justify-content-between align-items-center">
                        <div class="nav-tabs-buttons text-start">
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'general-info' ? 'btn-success active-tab' : 'btn-outline-success'"
                                t-on-click="() => this.state.activeTab = 'general-info'">
                                Info
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'frame' ? 'btn-info active-tab' : 'btn-outline-info'"
                                t-on-click="() => this.state.activeTab = 'frame'">
                                Frame
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'sash' ? 'btn-info active-tab' : 'btn-outline-info'"
                                t-on-click="() => this.state.activeTab = 'sash'">
                                Sash
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'glass' ? 'btn-info active-tab' : 'btn-outline-info'"
                                t-on-click="() => this.state.activeTab = 'glass'">
                                Glass
                            </button>
                        </div>
                    </div>
                    
                    <!-- Second row of tabs for additional tables -->
                    <div class="nav-tabs-container mb-3 d-flex justify-content-start align-items-center">
                        <div class="nav-tabs-buttons text-start">
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'order' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'order'">
                                Order
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'glass-order-table' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'glass-order-table'">
                                Glass Order Table
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'screen' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'screen'">
                                Screen
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'parts' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'parts'">
                                Parts
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'grid' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'grid'">
                                Grid
                            </button>
                            <button class="btn mx-1" 
                                t-att-class="state.activeTab === 'label' ? 'btn-secondary active-tab' : 'btn-outline-secondary'"
                                t-on-click="() => this.state.activeTab = 'label'">
                                Label
                            </button>
                        </div>
                    </div>
                    
                    <!-- 基本信息表格区域 -->
                    <div t-if="state.activeTab === 'general-info'" class="cutting-list-container" style="max-width: 210mm; margin: 0 auto; padding: 10mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-4">
                            <h2 style="font-size: 18px; font-weight: bold;">Info</h2>
                        </div>
                        
                        <div class="batch-info mb-3" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 12px;">
                                <thead>
                                    <tr>
                                        <th style="width: 15%;">Customer</th>
                                        <th style="width: 6%;">ID</th>
                                        <th style="width: 8%;">Style</th>
                                        <th style="width: 8%;">W</th>
                                        <th style="width: 8%;">H</th>
                                        <th style="width: 6%;">FH</th>
                                        <th style="width: 10%;">Frame</th>
                                        <th style="width: 10%;">Glass</th>
                                        <th style="width: 7%;">Argon</th>
                                        <th style="width: 7%;">Grid</th>
                                        <th style="width: 8%;">Color</th>
                                        <th style="width: 15%;">Note</th>
                                        <th style="width: 6%;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="state.productLines.length === 0">
                                        <tr>
                                            <td colspan="13" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.productLines" t-as="line" t-key="line.id">
                                        <tr>
                                            <td><t t-esc="line.customer"/></td>
                                            <td><t t-esc="line.id"/></td>
                                            <td><t t-esc="line.style"/></td>
                                            <td><t t-esc="line.width"/></td>
                                            <td><t t-esc="line.height"/></td>
                                            <td><t t-esc="line.fh"/></td>
                                            <td><t t-esc="line.frame"/></td>
                                            <td><t t-esc="line.glass"/></td>
                                            <td><t t-esc="line.argon"/></td>
                                            <td><t t-esc="(line.grid || '') + (line.grid_size ? ' ' + line.grid_size : '')"/></td>
                                            <td><t t-esc="line.color"/></td>
                                            <td><t t-esc="line.note"/></td>
                                            <td><t t-esc="line.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Frame table -->
                    <div t-if="state.activeTab === 'frame'" class="cutting-list-container" style="max-width: 210mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Frame Details</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 900px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 55px; width: 55px;">Batch</th>
                                        <th style="min-width: 35px; width: 35px;">Style</th>
                                        <th style="min-width: 67px; width: 67px;">82-02B--</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-02B|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-10--</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-10|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-01--</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-01|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-01G4</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-01J4</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 50px; width: 50px;">Color</th>
                                        <th style="min-width: 25px; width: 25px;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.frameData || state.frameData.length === 0">
                                        <tr>
                                            <td colspan="20" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.frameData" t-as="row" t-key="row.id">
                                        <tr>
                                            <td><t t-esc="row.batch"/></td>
                                            <td><t t-esc="row.style"/></td>
                                            <td><t t-esc="row['82-02B--']"/></td>
                                            <td><t t-esc="row['82-02BPcs']"/></td>
                                            <td><t t-esc="row['82-02B|']"/></td>
                                            <td><t t-esc="row['82-02B|Pcs']"/></td>
                                            <td><t t-esc="row['82-10--']"/></td>
                                            <td><t t-esc="row['82-10Pcs']"/></td>
                                            <td><t t-esc="row['82-10|']"/></td>
                                            <td><t t-esc="row['82-10|Pcs']"/></td>
                                            <td><t t-esc="row['82-01--']"/></td>
                                            <td><t t-esc="row['82-01Pcs']"/></td>
                                            <td><t t-esc="row['82-01|']"/></td>
                                            <td><t t-esc="row['82-01|Pcs']"/></td>
                                            <td><t t-esc="row['82-01G4']"/></td>
                                            <td><t t-esc="row['82-01G4Pcs']"/></td>
                                            <td><t t-esc="row['82-01J4']"/></td>
                                            <td><t t-esc="row['82-01J4Pcs']"/></td>
                                            <td><t t-esc="row.color"/></td>
                                            <td><t t-esc="row.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Sash table -->
                    <div t-if="state.activeTab === 'sash'" class="cutting-list-container" style="max-width: 210mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Sash Details</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 900px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 25px; width: 25px;">Batch</th>
                                        <th style="min-width: 35px; width: 35px;">Style</th>
                                        <th style="min-width: 67px; width: 67px;">82-03--</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-03|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-05|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-04--</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 67px; width: 67px;">82-04|</th>
                                        <th style="min-width: 25px; width: 25px;">Pcs</th>
                                        <th style="min-width: 50px; width: 50px;">Color</th>
                                        <th style="min-width: 25px; width: 25px;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.sashData || state.sashData.length === 0">
                                        <tr>
                                            <td colspan="14" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.sashData" t-as="row" t-key="row.id">
                                        <tr>
                                            <td><t t-esc="row.batch"/></td>
                                            <td><t t-esc="row.style"/></td>
                                            <td><t t-esc="row['82-03--']"/></td>
                                            <td><t t-esc="row['82-03Pcs']"/></td>
                                            <td><t t-esc="row['82-03|']"/></td>
                                            <td><t t-esc="row['82-03|Pcs']"/></td>
                                            <td><t t-esc="row['82-05|']"/></td>
                                            <td><t t-esc="row['82-05|Pcs']"/></td>
                                            <td><t t-esc="row['82-04--']"/></td>
                                            <td><t t-esc="row['82-04Pcs']"/></td>
                                            <td><t t-esc="row['82-04|']"/></td>
                                            <td><t t-esc="row['82-04|Pcs']"/></td>
                                            <td><t t-esc="row.color"/></td>
                                            <td><t t-esc="row.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Screen table -->
                    <div t-if="state.activeTab === 'screen'" class="cutting-list-container" style="max-width: 210mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Screen</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 900px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 120px; width: 120px;">Customer</th>
                                        <th style="min-width: 35px; width: 35px;">ID</th>
                                        <th style="min-width: 55px; width: 55px;">Style</th>
                                        <th style="min-width: 80px; width: 80px;">ScreenW</th>
                                        <th style="min-width: 35px; width: 35px;">pcs</th>
                                        <th style="min-width: 80px; width: 80px;">ScreenH</th>
                                        <th style="min-width: 35px; width: 35px;">pcs</th>
                                        <th style="min-width: 55px; width: 55px;">Color</th>
                                        <th style="min-width: 35px; width: 35px;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.screenData || state.screenData.length === 0">
                                        <tr>
                                            <td colspan="9" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.screenData" t-as="row" t-key="row.id">
                                        <tr>
                                            <td><t t-esc="row.customer"/></td>
                                            <td><t t-esc="row.lineId"/></td>
                                            <td><t t-esc="row.style"/></td>
                                            <td><t t-esc="row.screenw"/></td>
                                            <td><t t-esc="row.screenwPcs"/></td>
                                            <td><t t-esc="row.screenh"/></td>
                                            <td><t t-esc="row.screenhPcs"/></td>
                                            <td><t t-esc="row.color"/></td>
                                            <td><t t-esc="row.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Parts table -->
                    <div t-if="state.activeTab === 'parts'" class="cutting-list-container" style="max-width: 210mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Parts</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 900px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 60px; width: 60px;">Batch</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                        <th style="min-width: 55px; width: 55px;">Style</th>
                                        <th style="min-width: 60px; width: 60px;">Mullion</th>
                                        <th style="min-width: 60px; width: 60px;">Mullion Aluminum</th>
                                        <th style="min-width: 60px; width: 60px;">Handle Aluminum</th>
                                        <th style="min-width: 35px; width: 35px;">Pcs</th>
                                        <th style="min-width: 60px; width: 60px;">Track</th>
                                        <th style="min-width: 80px; width: 80px;">Cover--</th>
                                        <th style="min-width: 80px; width: 80px;">Cover|</th>
                                        <th style="min-width: 55px; width: 55px;">Big Mullion</th>
                                        <th style="min-width: 35px; width: 35px;">pcs</th>
                                        <th style="min-width: 55px; width: 55px;">Big Mullion2</th>
                                        <th style="min-width: 35px; width: 35px;">pcs</th>
                                        <th style="min-width: 55px; width: 55px;">Slop</th>
                                        <th style="min-width: 55px; width: 55px;">Color</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.partsData || state.partsData.length === 0">
                                        <tr>
                                            <td colspan="17" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.partsData" t-as="row" t-key="row.id">
                                        <tr>
                                            <td><t t-esc="row.batch"/></td>
                                            <td><t t-esc="row.lineId"/></td>
                                            <td><t t-esc="row.style"/></td>
                                            <td><t t-esc="row.mullion"/></td>
                                            <td><t t-esc="row.centerAlu"/></td>
                                            <td><t t-esc="row.handleAlu"/></td>
                                            <td><t t-esc="row.handlePcs"/></td>
                                            <td><t t-esc="row.track"/></td>
                                            <td><t t-esc="row.coverH"/></td>
                                            <td><t t-esc="row.coverV"/></td>
                                            <td><t t-esc="row.largeMullion"/></td>
                                            <td><t t-esc="row.largeMullionPcs"/></td>
                                            <td><t t-esc="row.largeMullion2"/></td>
                                            <td><t t-esc="row.largeMullion2Pcs"/></td>
                                            <td><t t-esc="row.slop"/></td>
                                            <td><t t-esc="row.color"/></td>
                                            <td><t t-esc="row.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Grid table -->
                    <div t-if="state.activeTab === 'grid'" class="cutting-list-container" style="max-width: 250mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Grid</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 1200px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 70px; width: 70px;">Batch</th>
                                        <th style="min-width: 55px; width: 55px;">Style</th>
                                        <th style="min-width: 80px; width: 80px;">Grid Style</th>
                                        <th colspan="5" style="min-width: 300px; width: 300px; text-align: center;">Sash</th>
                                        <th colspan="5" style="min-width: 300px; width: 300px; text-align: center;">Fixed</th>
                                        <th style="min-width: 70px; width: 70px;">Color</th>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                        <th style="min-width: 60px; width: 60px;">W1</th>
                                        <th style="min-width: 40px; width: 40px;">Pcs</th>
                                        <th style="min-width: 40px; width: 40px;">一刀</th>
                                        <th style="min-width: 60px; width: 60px;">H1</th>
                                        <th style="min-width: 40px; width: 40px;">Pcs</th>
                                        <th style="min-width: 40px; width: 40px;">一刀</th>
                                        <th style="min-width: 60px; width: 60px;">W2</th>
                                        <th style="min-width: 40px; width: 40px;">Pcs</th>
                                        <th style="min-width: 40px; width: 40px;">一刀</th>
                                        <th style="min-width: 60px; width: 60px;">H2</th>
                                        <th style="min-width: 40px; width: 40px;">Pcs</th>
                                        <th style="min-width: 40px; width: 40px;">一刀</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                        <th style="min-width: 100px; width: 100px;">Note</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.gridData || state.gridData.length === 0">
                                        <tr>
                                            <td colspan="18" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.gridData" t-as="row" t-key="row.id">
                                        <tr>
                                            <td><t t-esc="row.batch"/></td>
                                            <td><t t-esc="row.style"/></td>
                                            <td><t t-esc="row.gridStyle"/></td>
                                            <td><t t-esc="row.w1"/></td>
                                            <td><t t-esc="row.w1Pcs"/></td>
                                            <td><t t-esc="row.w1Cut"/></td>
                                            <td><t t-esc="row.h1"/></td>
                                            <td><t t-esc="row.h1Pcs"/></td>
                                            <td><t t-esc="row.h1Cut"/></td>
                                            <td><t t-esc="row.w2"/></td>
                                            <td><t t-esc="row.w2Pcs"/></td>
                                            <td><t t-esc="row.w2Cut"/></td>
                                            <td><t t-esc="row.h2"/></td>
                                            <td><t t-esc="row.h2Pcs"/></td>
                                            <td><t t-esc="row.h2Cut"/></td>
                                            <td><t t-esc="row.id"/></td>
                                            <td><t t-esc="row.note"/></td>
                                            <td><t t-esc="row.color"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Label table -->
                    <div t-if="state.activeTab === 'label'" class="cutting-list-container" style="max-width: 250mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Label</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 1200px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 80px; width: 80px;">Batch NO.</th>
                                        <th style="min-width: 100px; width: 100px;">Customer</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                        <th style="min-width: 60px; width: 60px;">Style</th>
                                        <th style="min-width: 100px; width: 100px;">Size</th>
                                        <th style="min-width: 80px; width: 80px;">Frame</th>
                                        <th style="min-width: 100px; width: 100px;">Glass</th>
                                        <th style="min-width: 60px; width: 60px;">Grid</th>
                                        <th style="min-width: 100px; width: 100px;">P.O</th>
                                        <th style="min-width: 120px; width: 120px;">Invoices Num. Batch NO.</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.productLines || state.productLines.length === 0">
                                        <tr>
                                            <td colspan="10" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.productLines" t-as="line" t-key="line.id">
                                        <tr>
                                            <td><t t-esc="state.batchNumber"/></td>
                                            <td><t t-esc="line.customer"/></td>
                                            <td><t t-esc="line.id"/></td>
                                            <td><t t-esc="line.style"/></td>
                                            <td><t t-esc="line.width + ' x ' + line.height"/></td>
                                            <td><t t-esc="line.frame"/></td>
                                            <td><t t-esc="line.glass + (line.argon ? '+Argon' : '')"/></td>
                                            <td><t t-esc="(line.grid || '') + (line.grid_size ? ' ' + line.grid_size : '')"/></td>
                                            <td><t t-esc="line.po || ''"/></td>
                                            <td><t t-esc="state.batchNumber"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Glass table -->
                    <div t-if="state.activeTab === 'glass'" class="cutting-list-container" style="max-width: 250mm; margin: 0 auto; padding: 3mm; border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
                        <div class="header text-center mb-3">
                            <h2 style="font-size: 18px; font-weight: bold;">Glass</h2>
                        </div>
                        
                        <div class="batch-info mb-2" style="font-size: 14px; font-weight: bold;">
                            <strong>Batch NO.: </strong><span t-esc="state.batchNumber"/>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" style="width: 100%; font-size: 11px; min-width: 1200px;">
                                <thead>
                                    <tr>
                                        <th style="min-width: 70px; width: 70px;">Customer</th>
                                        <th style="min-width: 40px; width: 40px;">Style</th>
                                        <th style="min-width: 40px; width: 40px;">W</th>
                                        <th style="min-width: 40px; width: 40px;">H</th>
                                        <th style="min-width: 40px; width: 40px;">FH</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                        <th style="min-width: 40px; width: 40px;">line #</th>
                                        <th style="min-width: 40px; width: 40px;">Quantity</th>
                                        <th style="min-width: 80px; width: 80px;">Glass Type</th>
                                        <th style="min-width: 60px; width: 60px;">Tmprd</th>
                                        <th style="min-width: 60px; width: 60px;">Thick</th>
                                        <th style="min-width: 60px; width: 60px;">Width</th>
                                        <th style="min-width: 60px; width: 60px;">Height</th>
                                        <th style="min-width: 60px; width: 60px;">Grid</th>
                                        <th style="min-width: 60px; width: 60px;">Argon</th>
                                        <th style="min-width: 40px; width: 40px;">ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="!state.glassData || state.glassData.length === 0">
                                        <tr>
                                            <td colspan="16" class="text-center">No data</td>
                                        </tr>
                                    </t>
                                    <t t-foreach="state.glassData" t-as="row" t-key="row.id + '-' + row.lineNumber">
                                        <tr>
                                            <td t-if="row.isFirstLine"><t t-esc="row.customer"/></td>
                                            <td t-else=""/>
                                            <td t-if="row.isFirstLine"><t t-esc="row.style"/></td>
                                            <td t-else=""/>
                                            <td t-if="row.isFirstLine"><t t-esc="row.width"/></td>
                                            <td t-else=""/>
                                            <td t-if="row.isFirstLine"><t t-esc="row.height"/></td>
                                            <td t-else=""/>
                                            <td t-if="row.isFirstLine"><t t-esc="row.fh"/></td>
                                            <td t-else=""/>
                                            <td t-if="row.isFirstLine"><t t-esc="row.id"/></td>
                                            <td t-else=""/>
                                            <td><t t-esc="row.lineNumber"/></td>
                                            <td><t t-esc="row.quantity"/></td>
                                            <td><t t-esc="row.glassType"/></td>
                                            <td><t t-esc="row.tempered"/></td>
                                            <td><t t-esc="row.thickness"/></td>
                                            <td><t t-esc="row.glassWidth"/></td>
                                            <td><t t-esc="row.glassHeight"/></td>
                                            <td><t t-esc="row.grid"/></td>
                                            <td><t t-esc="row.argon"/></td>
                                            <td><t t-esc="row.id"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </t>
            </div>
        </div>
    </t>
</templates> 